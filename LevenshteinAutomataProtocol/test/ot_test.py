import numpy as np
from LevenshteinAutomataProtocol.src.ot import encode_message, decode_message, OTSender, OTReceiver
from phe import paillier
from LevenshteinAutomataProtocol.src.communication import ServerSocket, ClientSocket


class TestEncoder:
    def test_encoding(self):
        arr = np.array([
            np.random.bytes(100),
            np.random.bytes(100),
            np.random.bytes(100)
        ])
        data = arr[0] + arr[1] + arr[2]
        chunk1 = data[0:256]
        assert len(chunk1) == 256
        chunk2 = data[256:]
        assert len(chunk2) == 44
        res = {
            "lc": 44,
            "vals": [
                int.from_bytes(chunk1, 'big'),
                int.from_bytes(chunk2, 'big')
            ]
        }

        res2 = encode_message(arr)
        assert res == res2

    def test_decoding(self):
        arr = np.array([
            np.random.bytes(100),
            np.random.bytes(100),
            np.random.bytes(100)
        ])
        data = arr[0] + arr[1] + arr[2]
        chunk1 = data[0:256]
        assert len(chunk1) == 256
        chunk2 = data[256:]
        assert len(chunk2) == 44
        d = {
            "lc": 44,
            "vals": [
                int.from_bytes(chunk1, 'big'),
                int.from_bytes(chunk2, 'big')
            ]
        }

        res = decode_message(d, 100)
        assert (res == arr).all()

    def test_enc_dec(self):
        arr = np.array([
            np.random.bytes(100),
            np.random.bytes(100),
            np.random.bytes(100),
            np.random.bytes(100),
            np.random.bytes(100),
            np.random.bytes(100)
        ])

        enc = encode_message(arr)
        assert enc['lc'] == 88
        assert len(enc['vals']) == 3

        dec = decode_message(enc, 100)
        assert (dec == arr).all()

        arr = np.array([b'asdfg', b'hklpo'])
        enc = encode_message(arr)
        dec = decode_message(enc, 5)
        assert (dec == arr).all()


pk = paillier.PaillierPublicKey(
    4705964732092977493086560386626438048649770880106897606640175205624197690750367272440666727504085607422359977335364696343395617147790470047733181992863396832514046398178993554292914294607596219141734268595540841764868526547598736674979799677053344349025047288187883881695725168351269815356657204595180275392828995931784858863832323860404328784960107613095366915473222390134631179939277264553302486521711492033377089927053545136665203140994076281291195138959457341970151637024559053874199454615327612566393737681740426222549933002787272137607562298344970110347950396603331436673422279458426930732797166388049887143349262585827154707654438498208237696601002730548857968225543428481703759812857485951990913001916951022415219873772852840379251239884929469753627445213041367043517569889112807457946245543286970212231684157609315549247222376857125705895589430693584324384034004523384628795228251136860868267269973394155433419135699)
sk = paillier.PaillierPrivateKey(
    pk,
    2140796533195830358354160316221708910835711537152069320108748635547855374428236639648423715008741750787380806223756721022258223927767632823953488522226447288394932121696251209764926046152337675673111322872830211047274905609258739334049529536788371311192889102709819475724501651502717029020262523285846043126177950205206625357609239048974070841111945769782752881431049900675137245894518977864684741384370743226287631765101608402655738245944799723125521193828835307,
    2198230732870164444031948375988524765946016321007894680092417213162154083126545029263731250047524707028001391114371399815442343989961053815928658686728739115722980585107539875742203472802699196804429316314227090040807559064191500674725578641384808612595233056457770616333195165587359377004850148080167155984738499283023210493500136419669357896187997588597782317502482187482650945108220776542434677421412566829729683055497690499223459410023354372837538048075177657
)
matrix1 = np.array([[
                       b'\xfb\xbf\xbco\xc1\xd8\x9c\xb0\xd6K\x98\xb4\x85\x06f\xe9X\xb3,*S),&E\x81\xdb,\xf5\xbb?\x0en\xe0\xd8\xc7(\x95\xc9\xe8\xfe\xc9\xafo\xf0([\xc0Bw "z\xec)\xd8/~\xf6Q\xfb\xe9*\x01M\xb2\xe8\x13\x95j\xacft\x83\xb7#\xdf\xef<\xcb-\x13\xc7\xa3i\xe1\x86]\x9bJ2\xf1\xe7x\xf8\xcf\x07\n\xc1\xc1',
                       b"\xd0\r\x17\xca\xe5E\x17\x9e<\x1e\xd0\xe8\x00\xc76\x1f\x0f\xa0Jhk\xa2\t8h[\x12\xe2G\xa0>\xb3F%7-\x1e\xd6\xd8\xa4\x86\xb7\xf8'\x98\xfa1\xee\x8f\xf4\xc7\xf5\x96\xb3\x19\xe5\xfe\xb2y\x90T2\x01\x118\xf8\xd7\x06K\xf9\xf9\x120V\x91n<\xc3\xbaT\xecV\xb1i,\xf8WAZR\x15\xaf\xbe\xac?\xa3i\x84G\xf6",
                       b"\x85\x7f\x9e\xdc;\xc8\xfa\x97\xad\xf3\x85\xffv6\x96\x91W\x0e\xfe\x0c\x01\x8bK~\xddFs\n\xcc\xbeZ}\xe9\xdc:w{(\x92\xbe\x1f\xe0\xe9U\x8dM'\x99 \xb3t\xb7f3\x87\xc1R\x04\xb0\x11\x1a\xc63)\xec\xf7\xdc^\xd6\xae\xc1\x1d\x0b\x1e\xd8\xc5\x188!\xdb\x81'~*R\x90\xdb\xe3\x96\x87\xa7\xe1\x15.\xfaI\r\x91\x0c\xd5",
                       b'7VK\x94tW\xb5\xddn\x19\x9c\x07Lz\xe3\x1a2\xae\xf1\xf2L\x03\xebi\xdf0\xec\xfdI\x0c\x1fn\xd5\x9b\xc5^%\x9e\x84\xb0"\xc9\x0ft\xa0\xe8L\xab\xea\rU\xf3\xcf\xd2Z\xfa\x84)u\xae\xadVK\x19\x04\xdf\xe6\xcb\x1cC\x8c\x13(\xf4P@<JRt\xae!\xe5!\xdd\xcb\x0e\x12\x1ccY\xa0\x8f\xc0m\x1aG\x00\x12m',
                       b'\x0e\x8eJD&E6qdc\xe1%%\x81\xd1o\x8e]- K`U\x13p\x05\xc4~\xd0}J\x0f\x90\xe8f\xf3yv\x92X\xdb5f\x9aS\xddXO\xc5\xe6\xb3\x1b\xc2>\x13\x0b\xed\xcd\xd3\xf6\xae\x95\xdd\xe2}\xe4\x8dU\t \xfa9V\x14\xa8^\xb4p\xad\x03\xda#\xf3E\xfc~\x8c\x02Q\\a\x00S\x01\xb48Nyg\xd5'],
                   [
                       b'\x94\x8c\x15A}?\xb1\x92\x15\xe6\xf7q\xb1\xaf\xed\x95\xdb\xb4\x13\xd9\x86jZj\n-\x0e\xfb\xd6\xe9\xc3\xca\xd1\x81e\x9d\xf9(\xa8v\ny\x10\x97SO\x00RMC\x8d2\n\x7f\x88T\x19m0kF%G/\x8e\x90B!3\xd9\xbb\x02C\xae\xe5\x85<\xfc2\x10O9\xb8z\x9a\x00\xe0\x1b\xcf~\xd3/T\x83}o\xc9\x80\xf7\xdd',
                       b'(\x1f\xf6;\x0b\xfd\xc3\x1f\xc3.\x08\x0e\\\xd4`\xdc%\x8bD}\xc2\xc0\x89L\xa4\xedN\xf6\xdd\xa6w\xb2\xff\\,\xea\xefp6\xcd\xe2\xe0M\xed\x0e+\xf4_q\x96\x13\xea\xc0\xba\xc0\x97\xfd\xda\xafwyQ\x11\xba\xc1x\xcb\xee\xf4\xa8[\x85\xa1"\xd9:\xfb\x8c\xca:4\xe2\xc5\'s\x07\x08\xd4L\x1b\x8c\xd0U\xc1\x19$\x19\xa3\xab@',
                       b'\xa6Tk\xb6\x9b%\x03\x84\x81\xc5Qn\xf5\xaf\xe5\x94\x1fkVQQW\x04P\x95YiJs\x91\x00\xea\x08B+\xaf\xfb\xd4x,G\x07_\xb2\xf2Wj\xa1\xa8\x9a\x10\xc2\xf9k\x12q\x0bn\xd4\xaf\xb5\xf0\xfe\xe4\xcfe\xbbj\x94w\x9cP\x9aeG-\xed:\x9e\xfe\xed\xe7\x9cP.\xac\xb4X,\x8e/|\xf0\x08#\x18J<\xce\xc5',
                       b'\xa1wA+\xb0\xe6B\xc56\x9cC\xb3\x80?\xed\x8cYVc\xeaD\x14Pl\xa4\xa0\xcb\xd1\x83k\x1cxNvvI\x14\xdc\xbb\x01!\x8a\x0e\x84\x1a\xf7\xc7\xe9=\xd4mg\x0f\xb7\xd7\xdf\xcc)\x1d\x80\x97j\xd5|S\xc1q\xca\xb8\xccf\x90\xf9\x87\x04\x86\xd7a\x84d?(\x8em\xba\xd3}\xf5\xec\xde\xdb8H\xdca\xc8\xf9\xfd\x91\xbd',
                       b'\xb1\xf2|A\xa6\xa5x\x1a\xd2f`\xdbRA(\xebP\xaf\xdd\x15x\xcc\xf4N-JL\xb3\xcb\xd7\xe4\x01\xf8|\r\xc3Q\x19\x8b\xe8S\x93}\x8d\xda\xd1\xf0\x8d\xfe\xc8\\\x1a\xd9/\x9b\xc2\xd9\x9c+\xfa\xe8z\x1c]\x03\xd2$C\xeeQLY\n\xd8\xeb1\x80\xca\xbde\xdd\xb3\xf4\x87\x7f\xf1\xc6\x03\xea%\x9f\xc2U\x17\xbe\x15YLt\x89'],
                   [
                       b'\x97\x87\xdc\x18\xfb|\x13\xbc7U\x94\xa6}_\xa9\xf7\x8ayq\xd4j_\x82=G6\xe2\xb3\x84\r\x7f\xdc\x7fu\xf4qJ\x88\xee\xc1\xff}\xaa?\xdd\xc1\xcff\xdd\xa6\x9c\x84@\xe0\x8a\x9d\xf5\x1ep\xa7\x0e\xaf\xc9W\xd2\xc2\xb5\x88-\xe1\x87\x19\xc1-\xbe\x02\x029\xa4\xad\t\xce\xb4(\x83\xed\xe0\x8c&\xf04\x8e\xfb\xdc\xec\xe41rc\x1c',
                       b"z\xa6\x17[O\xa7=\xc4f\x9cq\xd5\xd2\xa4\xa5\xcda\xc8\x8e-jw\xa2\x9d@\xb9\xf7\x11\x98\xf2\x13U\x03\xd0\xfa\xbf\xd9\xcb\xbfM\xa9'\x96Tg`f\xd6\xa8\x18\x12{\x88X!\xdd\xe2\xee!.\x9d\xab\x98,\xb8\x1c\xc1\xe5\xf3\xe5\xc9\xff\x84)@\xde\xcd3Q\xc8Cp&+\xc2@8n\xbaAW\x94E\x0b\xa0\x92Eh\xa7<",
                       b'G\x1c\xc6j\x86"\x07H\x9c\xcf\xfa\xae\n\xa1\x95\x1er^\'\xa5u\x7f$\x92\x0cf:\xd8\x8a(Bg\x9c \xcd\x85B\x8b\x83\x01\xda\xdfn4\x85\x0cV\xb0\x0b\xa1\x82Ley~\xdb\xc6\xd2\x99L\x92\x81\t\x15\x02\xdb\'ee\x13\xbdQ\x92N\x9e%L\xa6\xfa\x9eo\x93\x02\xbfs^\xd1\x84\xbe\xbf\xda\xa1\xfc\xfe\'t\x96\xab-&',
                       b'\x07\xea\xfb$\xae6\xb06[\x01\xd8}\x94l*\xf9\xbcX\xc7qk^3\x17B\x16\xc2\xfb\xf5u6\x1d\x0e\xbe\xfd\x82p\xa4\x0c\xf5\xed&;\xa4\x9bq\xb3\x9f\xba\x18\xe2\xa0\xd8\xd2Vi]\xd7\xff\xce=\x13^^\x99\x13z@g\x1f\xa4\x9c\xe5^\x13\x97\xa6\x89\xa6k<\\\xeaEt.l\xb9\xb2\xa43\xd1\xa4\x85NQ\x9f\x01\x1d}',
                       b'\xe3\x99\xe2\x16\xb2\xadIb\x88\xda\xf8\xa9\x03pu1\xe2G\x1a6,\xf6Q\x06\xce\xdc\xd6\xfa\x0f&erC\xf1\x8c\xdd\xc5K\xfcI\x7f\xb9`@\xe7||\x1f\xb4\x956s\xbe\x18\xebQa2uG\xe2\x19x\x1aW\x8f~\t\xbb\xf4\x11\xdaP9\xffs\x0f\x9a\x86\t\x1e\xac\xf2\xf7o\xeb\x0eTB-2W\xf1+y\xf2\xe0\x13\x8f\x8d'],
                   [
                       b'\x8c<H\x00V9\xbd\xfd\xfd8\x8d\x03\x9a\x10IJ\x0c\xf2\x9f\xf7\xb8\xd6\x91\xfe\xb0\x89\xf4\xa7\xae\t\xbf0\xc1Q\xf4\x8d\xc6;\xe9\xd3|u\x83\xa0\xb3M,@\xd1\x80\x0c\xdef\x97\xdc\n4Z\xfd\x90r\x10(\n\x0e\x0c\xed7\xaaE\xff3\xa3\x08Q\xffP\xe1O\xcb\x05\x90\xed\xfa#\xcc\x7f\x14\xc3&\xf4\xce-\xba\xf3\x94\xf9\x81,\x98',
                       b'\xc6(%W\xea%\xb99\xbc/t\xa0v\x8e\x87\x17<\x190\x1aq\x04\xd7\xba\xa57?\xe5\xa2+\x1f8\xa0SQ\x8e\xa6k C\x82\xd1?\xf1\xfb\xb2\xce;[\xcdo\xd4\xec\t\n#\xdf\x8bg\xc9r\xf7\xa3`\xda\xc5\x1b#E\x8d\xe0}\xab\xa0\xb0\xb2\x0cf\xfa\x01#\n,\xea\xe1\xb0\xae\xf5\xeb\xad\xeeE\x9f\x05\\\xdf\xe1\xdb\xff\x83',
                       b'U\x851ls\xda\xc4|\xa0\n\xf6\xfb\xf2\x9eL\x02.\x87&I\xbfq\xb0\tlF\xe4\xee\xf1S\x9d\xa8\x01 \x9aR\x16x+n\x1f)\x16\xf6\xc0\xb2\x0b~\x15\x02}&\x08\xb1\xfa\xa88\x93\x1b\x05\\\x9e<x\x02\xf0\xfa\tx.\x12\xd8\x84\xe5z\xe2"V\xdch\r\xf2F"+\xeb\xfb\xec\xc8L\x8b\xdf\x836\xbe <\x86\x10\xa2',
                       b'\x8b\x1e\xcf\tV\x19\xcc\r\x07-\xb5\xc4.\x12\xea\xc3\xab>%\xa5\xd4\x10\x87\x84s;%\x9d*\xf8~H\xae\x08\xdaO\x96\xc5\x12\xad\xee\xaa2\xf4Oo\x93il\xcc\x86\xce\xe2\xbes\x08\x00\xd5g\xed\x8d\x0f\x0e\x81\x84\xa8\xcd\x81[Lwmx9\xbaI\x0b RW\x13/Q1=(\xfbe6V\xacJ\xaf_\xc8\xf5\xab\x0bp\x8b',
                       b'Q\x7f$j\x04\x1c\xe3#\xb6\xfe\n\x80\x9d\x9d\xf2\x9d\xbaN\x7fc\xc4\x12\x9f\x92\xf40\x9b?\xb5\xdc\xe7Q\xc4\xf9\x91\xf7$VV|K\xe3\xf9\xa7\xffH]b<\xa5\x82\xf1\xfc\xfb\xbdH\x1ar\xa5F+\xbc\x16.\xa3}\x07\xfa.G\x9er 0\xda\x13\xfbt\xa1\xcf26\xbb\xa8\xbeL\xc5\xda\x1e\x00\xf3\xb9W}\xf3\xb2\x1d\x16~\x12'],
                   [
                       b'\xfcP\x1b\x06\xc1\x99G\x83\xe6\x16\xfb\x04P\x15TY~\x9bHU\x1e\xf5D\xa4\t\x84b\xa6\xd1\xdfvd4\x93\xb39\x9e\xb3\xbe\xdd\xc9\xbf\xc9\xb0iz?\xad\x99V\x7fP0,\x8am\x8c\xef\xe2\x81+\x80-\xb9\xfeA\x93=\x14eW,\x9dD\x15\xfer%\x15=)[\xb0W%\x92\x17\x1e\x80\xf2\x127\x90\xa3K\xf8\xbc\x94\tt',
                       b'\xf76\x13O\x91\xc0\x04\xc1Jf\xa5\x80l*[\x15*L\xbf/\x7f?\xac\x00\x836\xbb6z\x93\xf4po\xd2!\x85M\xeb\xe0u\x1f\x89K\xcf*\xe4\x03Wa7\xe7S\xf1\xd0w\xf7\x10\x1a+\xf5`\x08\x8fN\xf0\xe3\xd2\xa8\xacE\xf4w\xd3V|\xae^s\xafQ`\xb9\x0e\xbc\xcd\xd8\x0fy.\x8b\xf0w\x0bw4\x9d\xf7^\xbb\xcc',
                       b'\xc7\xe2\x91K\xa0\x07\x15\n6\xe4\xb5\xdd\x94\r\xc0\xd2\xa7\xcaY\xd1B\xe9"\xbe\xab\xb5\xd6\xb0\xed\xae\xe7\xe9\xff\xeb\x91\xcc~N\xd2\xb6\xa33y\x8ft\xb3_\xbfC\xbb\x1apR\xb02\xd0\xf3\x82\x12\xce\x12~\xe9Up\xd0\x81\xcdT\xf2\x87W\xf8\xefs\xd0\xfd\x1f\xff\x80\x11\x01E?A\xdd\xc1`\xbf9\x1a\xa5(z&\x7f\xa7y\x1fd',
                       b'E\xc7"R;\xd7\x90"7\x83w\xb4\xac\xa1s\x03\x9f\x1e\xbeq@\xc4\x03\x98\xf0g>-;\xe9\xc9!\x04\xa3t|J\xe41\x92\xb3\xe4\x8d=\xdb\x0b/r\xd9\xdd\xa0}\xff$\xee3\rhSD\xbe\xf2\xd4\xd7\xd0\xacS?,w\xd7r6AY\x9c\xeb\xb9\x01\xf1\x80s\xbb\xa8\xdf\xc4>P3\r\x13\xe3\x9e\xa0=s5\x82\xd4y',
                       b'\xed\x06\x95s1\xd6\xd4fL\x8d\xa4]\x8e\x1e\xce0\x07\xce\xbb_\xe3\x08\xdb\xaa;.\xbe\x9c\x7f\x03\t\xaa\xe5\xf06\xa7\xaf#\x9f\x19\x99\xd1\x10\xd0\xb3\xcc!s?\xcb\xa5l\r7^q\x7f\x9c\xf4!;\xb6\xb2\x8cu\x1a\xaam\xc3\xe7}\x0cHk(3<\xe0\xf1\xc3\x81\x8a\x7f\x07.a\x8b-fSv\xe0\x95\xb4\x8c\xaa\x1d\x88d/'],
                   [
                       b'\xa1x\x04\xf68m\xb7\xd3\xd5\xe3\xea\x0e\xa0\xcb\x04D\xcd\x0fp\x93\x99\xa5\xe9\xef\xca1\xd8\x8a|\xa5\xd5r\x1f8\xda\xbfH~^\xed\x19\x11#\xb9:|\x95\x8c\xa2\xca\x1a\x1bOZZ.@QI\xab3o\th(\xf8\xadU\xfc2\x9c\x89\xcf\xfb\xd0-]\xfa\x93M\x19\xb0\xd4J\xd2\xfc\x978\xdbm\x04\xa3n[:\xf0\xfd\x03uY',
                       b'-\xd7\xa3\x88\x05\x9b\xf5DQ\x0c<\xfc\x08\x12\xfa\xe4\x10\x9c\xc9\xd77\xdbI\x8c96oR>i\xe6\xb5\xa4\x046\xe92\xe6\xb8\xe9[R)\xab\x9a\x82\xb9A\xe6\xea24\xeb-\x8ez\xad\x80\x85\xda\xa8<\x91\x10\xe9et\xd1\xff\xff\x95@<K\x00\xfc\xab4\x88\xc7\xd8\xf8\x10&<u`H0\xaed\x84S\xdc^\x02se\xed\xe7',
                       b'\xf5\x12\xd88^c\x98\xd5\xc2O:6I\x13\xb2J\t\x8c\x0c\t\xbf\x03\x9bT\xc9\xff\xc6\xd0\xd2^#\xe4\xb4\xaa\xf0\xd5\xc46N`\xbf\x7fg\xdb}\xdf\x97\x12\x16\x84\xafy\xd3EjXA\xa3\x84a1\xd0W\x13,A\x0bCL\xa1\xa8\xf7\xb7\xf0=\xad\xfae\x9eknq94\x9b\xe0\xe2\x9b\x8dg\xb6\x1d\xc4\xf1WA\xa3%\xed\x80',
                       b"\xfc\x8d\xb3\xd9\x8ad9o\x1e\x98\x05TS\xcd\xd1b9|Xd\xe9\x9e\x9b,\xd8\xad>\x92\x1eo\xfc\x05#\x12\xa3\xe8\xfe\xa6-\xcfd\x0cn\xf4\xc4\xd1B?Nv\xdff\xfa\x12\x92\x89\x99\x8a\xee\xe1-\xad\x06\xeb\xad\xfc'\xd5\xbf#0\x8b-\x81\x92\x0c\xd1\x83\xf9\xfc\xba\xd9\xa4!\x1d[5\xbd%n\xe0}\x10rG\n?d\xa2x",
                       b'b\xfb\x1cj\x8c\xf1\x98\xe85\xb643\xfd;\x88T\x966\xbb\xf1N\x19+\x97\xde\xfd[\xa6o\x04\x1f!z;\x0ej\xfc\x84\xc9\x90\x10\xa5U\xd5c\xc4c)\x16l\x04\xce_!\xf0_\xba\xde\xcc\x84\xed\xdf7\\\x86}\x14o\xcc\xf2)\x10\xad\xfa\x93\x13{ZV\xfa\x9b\x03\xb8\xce\xe4\x88\x97\xb6\x11\t[E\xc0\x8d\x04\\\xd9\xfc\xf3='],
                   [
                       b'\xf6h\x02A\xdc\x9b:\xcb\xab\xed_0\x9b\x18*\x04\xa5/\x8a\xc1y\xad\xc1\xd9\xc6\x9f\x1d\xad\xb8\xbd3\xe7\x1c\x08X\xb3\xa20\x15N\x11!\x041"!)\xfd\xdc\xd2\xee\x1a\xf2qOJ\x7f\xb2\x06\xf5a\xbb*\xaa\xea\xbd\xb7F\x7f\xb6\xb7#\x1d\xba\xa6\xe1\x1f\xa1\xdb\xde\x85\xbfQRf\x93[\xe3\xe3?h}\x9eC\xce7\xdem\xc7j',
                       b'\xec\x18*\xb99\xb6-\xb8rF\x89\xd0\xadn\xc6\xbc_\x8f\x7fg\xd0\xd9Q\xd7\x1d\xcdZw\xa3{\xc6\x85\x9f\x04f\xf23\xa7{\xc4\n\xc3\x88\x16\xd5C\x1c\x8e \x97[\x85\xe9\x94\xf7\xfeRp\xbb)0\xcf\xda\xc9\xd8\xea\xb6\xf4\xc3\x0e<S,lx\xaeF6\x08\x87\xca\x83f\xd9\xce\xcd\x95\x8b\x8e}{M7\x00c\xd3I\xaa\xf7\xf0',
                       b'\rw\xbe7\xf7F\xe1\x1d\xbe\xab[]V\xb6\x86qA\xac\x97Mhs\xa29\xe1\xc7\xc1\x05\xb9\xf8,\xb1\x90r8\xaa\x84_A\xf14\x1f\xc8\xa9\x1b\xa6\rA-\x90\n\x92\x1f\xd4\rI\x9e+\x7f\xbb*H\xdct|\xcf\x02G\xf8\x85[BZL\xca\xcde\x13\xf7\x14\xf0\x0c({\xbe\x06\xa6\xe1\xec\xe6]\x03b\xe1\x0f\x98K\x192\xfd',
                       b'1wM\xaan!\xcc\xfe\xed\x98\x16\x93\xd2\xb6\xfa\xab+Z\x94\xff\xe9\xba~\x9b\x11\xc2\xc44\xba\x06o\x0c}\xe2\xc4\x8c$p\x97K\x85\xb7\\\x92\x9f\xd6\xa8>\x8b\xf1\xebU /+\xb4n\x8d[\x80\xb7n\xf7\xe7\x88\xd2\xda&\xc9\x9b\x97<\xcbB\xe8=Z\x13\xd0fM\x97\x89\xb0\xd5;\xf7 xA\xa2\x98\xe4\x14|\xd9\x92\x98\xf1\xec',
                       b'FL\xf3\xbe=\xf7\xd6\xb49J\x0e\x9a\xc0t\xdeN\xd8\xce!\x81\x14\xe1\xb2\xf3\xa2\x99\xb8\xe1\xa8\x87\xef\x87\x855\xd8\xaa\x03\xd3d\xe8\x86\x8cIEQ\x8f\xc4\xe0d\x10U~<\xe9\xf7q\xdf[_L\x9b\xd9V\xce\x84H\x9fA%\xf9\x8e\xf0`w\xe89q\x15\xb6r\xb0\xe9\x91\xdeD\xdd\x80\xc71\x94}\x02]\xde\xe9\x11\x99\x84\xf0\xd6'],
                   [
                       b'nW\x1e\xab\x9c\xbb\xdcj]\xb0kO\xc6\x81\xec\x8d\t*"g\xf3\xa3#E;\xeda\xc3\x91~\x97\x8e\xcb\xf0\xa8m\xae\xa2zM1\xef\xb3\xef\xae\xc3\x8d\xd3%+\x81\x81\xf4\x82\xdd\x94Z6=\xf0S\xa0\xf4\xc6Q=\x8eD\x13\xe0\x8c\xf0!\x1e\x1f\x92\xe9\xa1\xbb\x96\xfbBJ_\x16\x17\xfeB\xe0#\xa1\x01r\x9c&\xbb\xddNRk',
                       b'\xfbA\x88\x14I\xc7ss\xbb\x1b\xe7\x99\xdf|\x99\t#:\xe1{\x08L)yo\xb4nb\xe0\xcb\x8br] \xab\x1a\xd8\x1c\xf5\xb1\x02\xad\xf0\xa3\xca\xc2\xf4\xaf\x92\xcc\x07\xbf\xa2\x90\x9f_\x06S\x7f\xae\xccL3\x1c\xc0\x87\xab\xdb\xb0\xec\xc4\xe6uZzY\xc7%8B\xf8\x94x\x87|\xefz.\xe8\xb0\xfb\x98G\xd1|\xa7\xf4\xf1\\"',
                       b'ZVM`v\xca\xe6UZ\xbb{\x0b\xf9-\x0c\t\xae\x8e\xc0\xac\tk+\x9eCtHt\xdc\xc0/5\xfd\x1e\x0e\xef\xb3\x7fk\x96\xf4\xa3\x8d\xbd\xd9!\xe3\xab\xe9m\xbdD\xe6\xe8MW\xdbw;rZ\xe2\x04G\x7f\xca\x9c\x18>\x99\xaf\xca\x04A\xfa(x\x1f\x84\x14\x96\xb4\xef5\x888w\xa3\xd0\xd0\x10\x80\xb5\xe9\xe4\x00\xcc\xe5es',
                       b'\x95\xa4/\x9c\xe0\x8fE\xf1\xbe\x8b\xd10\xeb\xc5m\xfc\x07x\xbc\xbd@\xf4(j\xd0\xf4\xc3\xf4\xa9/\xd3\xcd\xfc\xd337?l\x94\x8e\x19%\x87\xf0\xb6\xe9\xf9\xb1LC\xe2gA\xd4\xbc\xc2N\xd6OrP\xf4vh\xe8\x17\xc7\xf6\xac;\x8ay\xee):\xe2"\xe9\xce\xd8m\xe8H\xda\xf4\xb4\xa3A\x99\x91\x00k\x04,\x87\x9b\xaer\xc0\xb4',
                       b'\x17\xf8\xb5\x9c\x0fQ\x16$\x8f\x8f\x0by\x0b\x02\x16\xf35\xaf\xd0\r\xefF\xf0\xcbHz|:\xae\x13\xcev\x8bm\xc1\x84\x8e\xf5\x9b\x01\xeb5u\xa7\xfdU\xc4S.\xce\x83~\xd2_\x12L\x9f\xd9\xf3-\xdaI\xb5\xcc\xc1\x96\x87^p\x07\x95YQ\x98\x9e\x11\xca\x05\x9c \x82\xbb\xc4\x10\xf1s\xbe\\\xcf\x10~\x8d\xd1A\x9f\x13cU=?'],
                   [
                       b']#\xd8\x87\xbd*|&\xb0y\xa8\x95\x06\xec\xcdC\xe47J\x93\xd0\xa71\x934\xbd\xa8\xff\xb0%\xaa\x0ch\xf7\x13%3\x18\xf6\x00\xac\x08\x0c\xfe\xedX\x86\x14l\x87#-M\xaa\xab\xa8B\xad\x1fO\xb3\x82\x10\xb5V\xa5F\xe4\xc0\x89:#c\xd7\x00\xbc=\xbd\xbc:\xb2\xe6\xd8\x8d\x91iP\x02\x8dh\xbb\x9c\xb9\x03TO\xb7\xa1\x94\xee',
                       b'\x8d\x8c\xee\x9a\xed\xffl\xf3^\n\x90M\r/\xa6~\x90\x1f6r\xadE \xd0\xfa\xf15\xba\xc1\xe8\xfe\x92j\xacR`\xac\x96iq\x11\xa5\xbdD\x82+\x05\x05\x01K7Yq\xef5\xbd\x03\xd0\xafI2\x9b\xc0\xe4U{\\g\xf5\x8db\x88\x0f/\xbbR\xfc\xb1^\x0b\xe6\xc7<_F\xde\xceQ}\x9f \xd5Y\xc2\x88\x1f\xe5\x1b\xd8j',
                       b'U\xc5i\xb5\x10\x82\xb9\x18\xf6\x9c\xb8\x9dlT`\x9e\x94\xd2[\x143C\xd3YSU8\x8ce\xb3Q\xbb\xcf,\xacaL]\x17.\xc7\xd1\x1f\x82Yx\rj\xe2q<\xd9\xc2T]\xb1\t\x7f<\xaaS\xdd:l\x93\x92\x98W\t\x8b\x01)\x01R\xe1\x10\xb7ZG\x0cwHh\x96\xf5\x164\xa9V\xfe\x97\xf9\x13p9\x93\xfb\xbb\xc0\xb6',
                       b'YP\xfb\x84\xa8\x95\xb1I!\x7f\x8e\xeb\xfc/8\xc1?\x11E\xa9\xd2\xdc\xd9\xda.\x80J\xdc\xae\xb6\xfd\xa2\x8f@\xee\x1dQ\xbdyp\xfb\xe1\x9f\x14\xab\xeb\x1d\xd0A\xa8\xc3\x8e\xe9\xd5\xb8\x13u\xeb\xfc\xf4\x8b\xdd\x02^~\xf3\xd2\xfb\xcb\x7f\x8d>\xd9\x83f\xed\xcf \xa366i\x8b\xdcG\xe0\xf0c\x1cg\xe9\x14\x89e!j\xde49\\',
                       b"g\xbdk\x94u\xe3\x83]\x91\xdb(\xd1&\xd0\xd4\x1e\xb8\xbc\xffE\x10\xa2\x0b\x02e\xda\xd2\x0el7\x19a\x1b\x04\x8a\xc7\x86\x0b>\xcf\x92\x16Q\xc7i\xf8\xe5\xf3\xa10\x95e\xe3\x10\xc0\x02\x82\xc1Z\x8f\xa3\x03\xb7rw\x1a%\xff\x91\x89\xff)\x05i\xc3l\xb2\x8f2h^\x82$\xdd\x12\xb2\xa5L\x0bx\x8d\x13\x9d\xfc'<+\xa5\xacx"],
                   [
                       b'\xeex\xe7\xd6q\x19\xe9\xb6L\x10\x0fj0w\xad\xd8\x1c\'X!\x15\x05+\xa7|G\t\xb1f\x0er\x08\xf6\xc6\xd9\xa9\xa0"\xc5Sk\xaf}%\xf1W\xf4\xa1Ib\x11\xa0;\xc0\xd7\xcdTX(\xe3\xa4\xfb\xa1\xfb\xe3a\xfc\xd6\xa0\xd1\xee\x8a\xb6r\xdf\x83(\x8b\xc0\xa67\x94\xdf\x8f\x15wP\xe5\xb1\x1f#\x0f\x1e\xc8\xb0\x1f\r\x0f\xea\x03',
                       b"\x9c\x96\xf1\x82\xf3&7\x12\xe1\xba+\x18\xa4s \xcd\xfdr\xbd\xfet\xf1\x92\xf7\xad\xca\xa6\xa8d \xf6\xea\xac\x90n\xd7\xd5\xb8\xf9\x81\xe0\xeaI\xe8'\xd4c\xc6\x0fb\xd4\xa6\xfd\x11\xd1J\x9d\x89\xc0\xd7\x9d&&Z\xf6$\x16\x80\xb8\xe2\xc1j\x1fG\xfc\xb7\x84\x9e~\x8a\x04#^_\xab\x02G\x85n\xbd\x9b\xcd\xdf-H\xe0h\xe9\x9c\x9c",
                       b'\x9b\x8b\xcd\xa8D\xb5\x0eg\xc1x\x9da_\x12\x0b\x9drV\xfa\xb7\xf8\x07\x0bI\xc3`=i\x87\xbe\xa1D\x06Fb\xeac\xdf\xbe\x14]<\x18Wo\x03hm\xf3\xda\xe4\xcf\xb9\x07\x17\xbf\xf9\xf0\x16\x7fNz\xea\x80>\xadb\x99\xfe\xf8l\xb2\x82^\xc8[E\x82\xce\xe5\x18\x0e\x13-\x9a\xb4\xed\x048\xa5x\xdb\xf0\xad+\xc7?l\x80`',
                       b"\xe5\xe2V\xde\xbd\x08J;Y\x16I\x85\x03\x96\xa7\xbc\xa6y\xf4\x1a\x1e\x8f\xd2\xc4T\x16CT\xb4l6p\x12\xf4\xb4\x04\xa2\xe8]\xe4 \x1f\r\xfaQ\xc1\xef\x86`$M\xd7xGFT\x80\x9d\x14'\xeb\xae\xc7N\xee\xa8PQ?\xe0uC;^1h\x10\x98\x91\x00\xb3^\xfa\x16H\xe04\x1f\x12\xcd\x04\xb2\xab:\xe1\x189\xcd\x88\xb4",
                       b'9\x0ev\xbd\xa1\xach\x9dV}\x00x\xab\xaf\x8c\xa3`\xc9\xe7\x05\x9e\xc7q\x9e\x16\xe0\xf4\x0bE\xa0\xd1S}\x9b\xb5\xb8\x1c"\xc9\x14*#4\xc2Dz\x9f\x8d\'\x98\x01\xc3\xe1\xa4\xbd\x0c\x0f\x1d\xb4\x84\xadi\x90\xba\x10\x18t\x82/e\xe0J\xef\x1b\x1e^\x1d\xc6\xf3\xd9\x8fAb\x97\x02!\n\x15\xf8\xc9{\xf3\x05\x10BN\x90[@\xe3'],
                   [
                       b"\xeb{\xc0\x89\xcd&\x1b2\x00+\xdf\x96\xd3\xe9u!\x14\xbbf\x8f1\x85\xc6\xe4\xd9\x9b\xe4xx'JFS\x042\xc3O.\xfb\xa1\xb9<\xf3\x8a\xca\x1bg\xe3\x04\xbc\xe8\x10\xb6$\x927M\xea\x83\xc5V\xe6\x9f\xab\x1dM\x84\xbaw%\xa7~\xdd\x18'\x08\xab\x7f\xf4\xd3\xf7Amqo\xd8\xd3\x03V\x06\xbe\xd2\xd6\x90\xa1Q\xb6K|\xa2",
                       b'`\xa8\xd3\x87\x90Qb#e\xb1H\x81\xed\x9f!o\x14,w\xb9ArZI\x007\xfd\xcbI\xd8\xa7\x8d\x1d \x05\xec\xc3\x83\x07\xfd"\xc2\xea\xa2\x9b\x13\xd83\x1b2te\x83\xf1~\xb8\xdd\x12\xabBl\xf6Q6P@!\x8bnGy\x9a\xb2\xb6\xa5q\xff\x08\xb7\x99y\xbav[R\xe9|\xebh5#\x0e\x15<2x\xbe\xf7GB',
                       b"\x16p\xb5S\xb5\xd50i\xe9\xce\x88\xf5\xdc\x05P4H\xb9\xfc\xc0\x00\x07Z*\x0f\xe50\xd3K\xe2\x11*\xc5]*_q'0\x82\xa9\xbc\x8e,z\x1ac_\xbd\x19\xe0\xf6\xd3-7\x84C\xa00\xbe\x19\x987\xbbmul\xcb\xd5\x84BP\xe1\x8dK\xcc\xfc\x15\x94\xf9\x19C\x82\x9adI\x0b\x17\xe8\xa6\xc1x\xdcm\xbf\xb2\xf1C\xf1h",
                       b'\x9b\xd4T#O^\x97o\xeb\xe0\x06\x8f\xb1S\x0f\xf2\x80\xd2\xc00\x05\x05\xbf"]6|\xbd\x8c\xce7z\xa2\xbd0\x04\xe1K\x07;\x91\xdfS\x07\xea\xca\x95h\xa8Z~p5#h\x00W\xac\x85a\x07\xbd\x93\x11\xd4k4\xf6\x1b\xdb\x88\x0e?8\xa3\x86X\x04y\xa6\x16\x126\xb7\xf8\xca>\xc8\xf0\x92\xb2\xfc\xa5\x8f\xb2\x1c_`\x8bG',
                       b'@\xbe\xa3\xb2\xe2C\x10\xbc\n\xf9\x844\xb8\xa2\xc7\xa4#&\x05\x0e\x8b\x1673J{\xf3b=\xc6\x16,z\x93\x9a\x04B;\xb2\xa6\xcef3\xd4;\xc2\xca\xca0\xbe\x01\x9e\xa7\xb3mA\xf4\x82Dx!\xf3\x15\x7f\xea\xb0C|\xa1\xfbk\xd4\x87\xa5"G\x12\xa6\x82\x8ad*>B\xe60_h\xd1\xc6(S\x15}>\x8aH\xf6\xc7\xbd'],
                   [
                       b'h\\\x129\x05\x91\xce\x0c\x1a\x14@\xa5mgz\xf6\x02R\xa5\xd3Q\xa3\x1c\xf2\xafGa\xa0\xdd\xf0^EJ\\\xbd\xac\x9bp\xff\xa0\xfa\xc3\xf8\xd5\x0c`^\xc5\xca=\xba\xc9\xa5\xdf\xbe\xa8\x06\x9c|\xc1w\xc9\xdc\xc7\xf8\xdb\xbe\xee\\$T\x08WK\x97\xac\x02\xa7m\xce\x89\xad\xf38\x85~\x85&\x19\xf5\xf4\x0e\r\xfb\xb4\xfd\x05\x90t/',
                       b'c\x9f\x18\x9e\x97\xb7Z\xf0RM\xea\x1e\xe2z\x9d\x85\x17\xe2w\xbd\xdb\xc7\x99\xf9\rb\n\x10\xcd\xc8\x87\xfc\xea\xd2\xee\xd9\xba\xaf\xf3\x92\xc3N\xbd\x86\xbemb\xdd\xbfd\xcd\xa1\x0b\x1cv\xac:\xc9*Zv\xea\x15m\xf4\xa6F\x1a\x8d\xd6\xc8\xcd\x86Y\x82f\x01h\xc4\x8c\xc2*L\xd2\n\xf1\ts9\x1bZt&\xa6\xd8Y3\x81n\x9a',
                       b'e\xab\x8b\x11\xe9\x08\xb4\x10\x01\xad\xa9\xee\x01\x84\x9e\xa6\x82."\xaf`\x1e\xea\x93\x17\xbb(\xe3UxW\n\xb0\xaey\xce2\x8b\x9c\xd26\xb2xR\xa2\x10\xe6\xdcK\xd4"\x1c\x87\x89\x8c\x9a}~C\xb6\x12(\x15\xf0\t\xf9ck\x96\xce\xa7\xe6E\x92\x88\xadu)\xd6\x19\x16\x82\xf3gg\xe4\xa9\xcb\x0e\xaa%Z&\xc5\xef\xc6.\xfbM\x02',
                       b'[\xb7W"\xfa\x9b\xde\xf3X\x81J\xd8n\xf88\xc0\xd0|X\xc00\x86\x84z\xbe9#U\xa2\x7f\x02\xfaa))O\x01\xaa\xaa}\xb3\x90Kz~\x8d\x14\x8f4\xb5\xbf\xb0\xc7M#\xea\xde\x85\x9b4\xcd\x9d\xf0p\xe7Mvm\xf2\xa1\x14=\xe8\x83K|\xe9\xb8+\xba\xf4c\xd3 \xd8)\xb6E\x92\xdeK\n\xda\xf6\x9f\x7f\x88\x83\xaan',
                       b'`;\xa3\x88\xc1\x14\xea\xe7F\x8bV\x06\xe4\x10L\xa1\xfb\xd0\x8d\xab\xb8*~\xb3\xad+\xc3\x15\xed\xb3\x82\xff\xb3\xc8\xc0\x8ft\xfe\x9fy(\xcb>\x90y\xb3\xa0\xfePl\xe1\xcd\xf9D\xb7M\xd4\xd8J\x04X5$\xfc\xea\x8f)\xb3\x01\xa6{mdrl\xba\x15Pd\xd6\xd3\xdb@\x8bqb\xf4\xe2\xf5u,f\x98kyCD\r\xa0\x1f'],
                   [
                       b'd\xd8Bfx\xce\x18\x90\x8c\xe0\xe2\x82X\xaa7\x9an\x11\xa2\xd9\xee\x9bb\xa4\x9b\xfd.\\1v{\xcb\xbf\xd6\xb9\xb18\x9e\xdf\xea\x8b\xfe\xd6EG\xc0\xb6\xaaH_\xeb\x16&!\xf3<n\xdab\xbbkB\x99\xaa\xf3\x83_\xd5\n\xeeb\xcd\x8d \x04\x03a\xc71\xe1\xe2\xb2\xd2\xf2\xb7L\xe0\xde\xb7\x9d_\xed\xa2\xff\x0ch\xeb\xae\x05\xc2',
                       b'\x182\xa4\xacp\x9d*p\xf2\x12\xb6\x97\'t\xfc\t\x97S\xbfx\x92\x8f\xed\xf1\x1f0L\xdf\x8aI\x1e\x01Y\xf4\x95k\x19\x0f\x13\xaf[9\xd2\x8d`~\xd9x\x85\x07\x0f t\xe6\xd8\xf8%\x88\xd5\xf0\x01"}\x90g_\xd0,\x10\x18\xa4E\xe5\xa2&\x8c\xd9\xfe\xb7\x93\xa0R\xe3Jr\x94\xbb\xcbU\x80Q\xd3%\n\xb8\x12\x07`F\x0f',
                       b'\xfb\x01\x0e\xa0R\x16\t\xd3\x9b\xeci\x1e\x19 \xefY\']\xb3.\xc6$\xd8\xf6\xcd\x8b\x8a)\xd0y\x9f\x91\x9a\x0cj\r*\xd0\xcb\xe2\xce;\r"7\x02\x11\x06]<\xc9\x8b\x10\xd5K\xe36\xe7\x91\x1b\'o/\'\xe2\xf8&\x97\xbc\x85\xcf\x16?\xe0@\xcfxU\xae\xc2\xba\xae9\xbc.\xd4\x9f\xe5We<X\xeb\x8bk\x08m\xe9\x83\x11',
                       b'\xae\x12\x8a\xe5GP,\xd7\xc7\xf5mR\xd0\x19N\xcbn\xae\xf0O\x05\x12\x89\n\xde\r\xb5x\xcd\\\x1b\x17\xc9g\xa9G&|\xea\x8f\xdbAS\x1a\x1c\xb32\xfd\xcc\xae\x834\xd7B\xc5\x85\x8d\xfecL\xe1\x18\xce4\xa1\xc4\xd1#\xb7\x10K\x8b\t\xfe0\x8d\xd2\xc9\xb8\x95\x86\xb3\x94\xd8\x14\xe4u\xa7D\x81\xa6\x92\\W\xe4/\xce0fl',
                       b'\xf0\xe42\x8b1\xd3\xbf\x93\x10\xe5W\x10\xa3\x95re\xcf\xf3\x9c\xd1s\xb5\x1db\x18\xdc\xbbA\x9a\xd3\xc6oI\xe4\x94!\xcby:\xb2\xc3\t\xa2\x8a\tY\x19I-\xeaF\xe1R\x12\xec\xdbB\xb5Y\x89\xf6\xea\xfe\x9f{\x06\xc3\xf3vg&Tj\xf1\x92\x08\xf1\xf3y\x1c\xdf\x1d\x94\x01\x9fWw\xb0\xf0?N`]\xbd\x96Zy}\x15\x1e'],
                   [
                       b'\xce\xd0\x0e9CO\x85\xde\xcc\x0e\xef\x9d\xb69\xe7\xda\xf3\xcb\xf4\x82)\xa0\xa3dc\xcc\xda\x89\xb0\xdf)\xae\xe3\xdf\xca{Q\xaeo\x19X\xc3K\xf6\x8c\xaa\xc04\xeed&\x03\x9a\x97:H\x86\xda\x82\xf3\x93!\n^\x11\x9f@\x11S\x04\x80u-\xaa\xabf\xabs|[\x92W\xb2\xb71\x9d\xf8Il\xa4\xf7\x9bw\x8d\x91\xe0~\xda\x0e\x94',
                       b'\xf6\r\xc9\xa35c\x1b\x82\xa6\x02\x9apsI\x95\xd0\xa5\x07\xd4\r\x1e\xff\x1e\xa4"\xbby\xb2\x8f1\x9e\x9a\x04w\x1b\x8d\xa0\x02 \xa2:\x9f\xee\xa3\x87T3\x18\x1bu\x1f\xaaM\xa1y\x08\xbb\xef\xe4\xb4\x9f\xaf68\xbeU+\x1a\x92\x07B\x8b\xdemJl\xb2vxr\xf4\xc3\'\nN\x0cN53\xc4\xc3\xae{\xef\xe1\xe5_w\x1c\x11',
                       b'\xd8\xf0%\xf6\x93\xa1P{\xa12\xba\x18\x11`\xfeq\x9ca\xc47]t\x96\xfa\x97\xbf(Ux\x0b7\xa33\x9d\x94e\xfb<\xf7\xb5\xdcA\x86G\xaf#;\xbf\x03\x1c\xa30\x10\x1b3\xda\\P\xd1\x8b\xa1\x19\x0c-_1\xef\xfb\xc0\xaf\xaf\xf8\x90\x1cq\x96G\xb1\xb0\xb6\x96\x9f\xf3km7\x82x\x15\x18\xc3 \x86\xf1\x02!\xae\x91\x15\xa8',
                       b"\xdch'\x1b\xab\xd5@\xbb-\xd7J)\xe4\xf3\xb5\xcb\xd6SIk\x90\x00\x9b\x18W\xb3\xd7^\x0e\xb9;x\x9d5\x9e%\xfa7\x87\xf4\xb2K'\xe5\xb4\x13\xb5\xbe\xe2v\xa7\xdcD\xf9C\xc1\xb1\xa2U\xba\x9a\xc6\xe9\xc4rq\xf4\x06\t\xd5\xae\xc0x\xe0l\xf0u\xed\xdd\x82\x90\x01\xd6\xc2Q\x8dv\xdc_\xc3\xf7+Cl\xe1J\xc8}\xd7n",
                       b'i\x81,1.\xd7\t\x9fH~~\xe2)\xc6^3\x9b\xc7\x1d\xfc\x90\xb8f\xf8Hb\xcb\x0f\x0b\xaeg\xc2\xac\xf1X1\xc4\xba\x8d\xe1\xe1\x13H3\x9e\x95\xe37\x8bPY8\x08\xe3\xb1J\x00z\x93+X\x86\xd5@\rA\x86\x87+\xaf\xc2\xd7\xadV/(0\xba\xdb9@\xa4\xe0\t\xa0\xac8h\x93A1\x1c_t\xcb%y\xeb\xd4I'],
                   [
                       b'P\xba\x7fxN\x97\x80`\x84]B\x0e\xef\xe5\xcf\xc9\xb7)\xfa\xcf\xa5x\x03Q\xc2L\xce\t\xc5.\x13\xc9\x8f\x06@(T\xf7X\xd4=R\x9e\xa3\xd6\\\x96\x15D\xc9\xb4O\xfc\xed0\xf8\x1d\xfa\xf3\x7f\xdd\xf1K\xd3^\x13\xba\xf8P`\tL\x18\xcc\xaf\xcev\xdb\x99@\xd82!\x05\x05\xfc!\xf5\x1f\x03\xf1d\xd8\xbbtl\x9d.\x8fZ',
                       b"\xcb0\xf0\xb6\xf3\xb8h\\\xfe\x19\x99]\x0b{NoC@$\xbd\x02&2%Ld\xf1v\xfe\xf0n\xb4.T\xe2\x05\x98;\xe41\xa8\x86\xf1U\xd0\x16\xb3>\xa0\x98Ig\x18'\x87\xe6\x9f%&\x96\xc0\x17\x19\x18_3\xd2*\xb4\xc9q\x03\xb77\xf2\xc5TP\x98\xf4\xcc\xc4\xb8\x15q\xf34a\x14\xfc\x1c\xad\xe7c\xe9\xd9i\xd3\xef\x8b",
                       b'\xbd\xd7[K\t\xd5\x0cJQ\x9cK\xf8\xaaX\xca8\xeeG\xd0\xeb/{\xcam:D\xb9\xdc4\x90\xf2\xa7\xc7\x83\xc0U\x91\xae\'\x0enp!\xc9w(q\xaf&\x80\xf8\xa2^\x80\xd0\xf0)\xbf\xd9\x03"%\xdaW\x0b\xef\x99\xeax\x1b\xc6zN=\xd5\x9a\x96R\xaa\x9c\x83\xdf\xd5\xca\x7f\xd8\\\x8c\xe4M\x06\x0be\tu\x9d\xae\xbb\xd2\x92',
                       b'\xe6\x92\x18\xd4\xdbs@e\\L\x91\x11\x04\x9b<\xed\xf4\xdah\xf8\x14\x8d\xdd\xd7q\x11<S\xcb\xdb\xb1\x1b\x10%\xdd\xc5\x82\x0fq<\x0c\xe9\xc1Q\x15P\x91Pc\xbe\x8e\xec\x87\xe6\x94\x9f\xa3Z/\xbd\x9d\xfe\x16kb\xc8\x93\x17\xdb\xf0\x06\xa6\xac\x8b\xa2\xa2Tl\xa5\xb2\xf4\xf9\xcc\xfa?Hg\x994\xb3+\xbc\x8f\xef\xda#\xf3/\xb4D',
                       b'\xe3\xeb\xc3\x90&a\xfb!;\xda\xccF\xfcuZ\xa3}\xa9\xda\xf0\xbb\x1c\x94C\x06z\x82\x7f\x1b\x8c\x11\xe9n\x99\xa1\xdd\xe06,\x1a\x0e\xe5\x96\xf3\xd9\xfa\xf7\x97\xa1\x0c\xcc\xc6\xb4\x19\x17\xa2l{7\t>$\xa0+\xff\x07\x90\xab\xf5\xcaS\xf2\xa5\x9a<\x18p\x04\x8d}\x01\xe7p\xcb\xac\xeco`\xb0\xe8\x9d\x98\x1b\xe9f9~\x16(\xc4'],
                   [
                       b'\x8e\x04\x19\xed\x05a\xfd<\xdeb\xf1k\x077\xd2\xaa\x8e\x1c\xf8\xe3\xb1CHt7\x16\xa05\xde@\x7f\xe66\xfa\x04Z]\xc6\xf1\x90\x9d\x13\x00Yf\xb7\xb8 t\x0e\x8c\xf5\xa5`\xfd5p\xce\xefa\x0b#\xdd\xa2\xf8@@\xe8_\xdf\x9b;cj!\xafP\xeb}\x9a\x9ew\xb9\x11\xe0|j\xb1o\xa4\x19\xf3u~\xaf/]\xa7\xe8\xd1',
                       b'\x16\xe68U\x89Z*^\xb6`\x0er@\xaf0\x17\x96$\xbei\xf5\x00\x08q=g^Z\x8a\x93\xcf\x9eK\x07L\xa6\x9d\xae_\xba\xac\xe9e\xa75\xe6\xd0\xa0+,\x91V\xf6s\x8a\xac\x0cP\x88\x00,\xe9#!\xf8`\xd2\x1a\xe1\xaf);)\xbcXf\xc3}\x9fG\xe4`G\xbf\x04R\xaa\xbb3\x169$\xb9\x82$\x15f\xef\xdaF',
                       b'f\xcd\x966\xa2Z\x90\x00\xc9\x9c\xb9{:Q\rq\xfe\xcf\x82\xaa\xfb\xe9q`Dx\x1f\xd6#p\xae\xa0[x\xd7\xca\xa1\x8e\xe7J\x07?\xff\xc2n\xb2k-\xad\x9f\xe3\xb81\x15,H\r\x1ctN"Bt\x1d\xf2y\xbe\xd9\x01}\x929\xd36\x01\xe2CI\xc8\x8e\xe5\xfc\x8dvF\xd2\xd1Z\xa6\xde\x95H@\xd4\xafF\xae\xd6C',
                       b"\x08X\x9a?\xcb]\x99W\x06\n\xd5DR\x11\xac?\xf69\x82\xcc+\xffr\xa3\xde\xb6V\xe6\x84xuR\xc4TV\xf9(ytx+\x1f\rd\xca\xfc\xe8\x18\x93\xda\xefH\xa3\x1a\xd0\x9a\xce\xbc\xd8\xa1,It7Je\xb2'\xc4\xb6\rJS\xdbl\x97N-\x9d\rrF\xe9\xe4n#\x97\x19Bs\x90\x83\x08\xa6n\xd28HR\x05",
                       b'\xec\xedv]\x05R5\xba\xf1\xb5\x9a\xfa\xd7\xc5O\r\x98\xb1\xde\x8fr,\xed\x10\xe3g\x12\x86\x16\x904eqO\xa07\x12\xb3y\x0bR\x98V\xd0\x00j\xf3\x12\x05\x08\xb7\x97\xc4\xbd\x17\xacj\x8e\xdc\xab[\x08\xdb\xc0\x0er\x04\xa5\x8f@A\xf8\xba\xf1\xd80\xca\xd4\x80\xba\x87T\xc0\xce\x87\xb8h\xe2\xbbw\xfbFU\xde9\xfc\x8a\xa8\xec\x8d'],
                   [
                       b'\xc5\xcc\x96\x88\x94\x17Lx\x96\x91R\x9dL\xa39\xdb\xb4\xe9\xdetWM)\xf7\x08p\xe4"\x0bXy\x9d\xb32\x04D\x8b\x8f\r8\xa7\x0e\x8c\xd4\x16\xd5\xec\xb7H"\xe6\x1a\x85\x8e\xc0{\t\x1fd;p1\xb52\xc3\xa9\xb1\x15n;\xb4\xc7\x14Y\xb1\xa4\xb2\x01"\xe9{R\x89\x1b\x1e\x02rUg8\x83U\xaeZ\xa4\x87}\xde\xbb2',
                       b"\x88\x81\xa1p\xba\xec\x8d\x93Hm\x1axO\xbaHd\x8bA\x18\x91\x02\x16\x97\\P\xc6,`\n\xd1P\xd5\xf3lc\x90\xfdc?n\xbe\xfd\x9a\xa4\x8b1F_\x92Q\xb2A\xbbD\x00\x18\xf2\xcfb8\xe1@\xf6\x1b\xdc\xaeA\xe2'D\xaeuC2>'\x7f\x8bH!d=!1\xe2\xeb\xfd\x1c<\xdcz+\xf3Fb/\x9cno[",
                       b'\xf5\xc2a\xbd\x18\x9fF\xfdW\xffI*:\xb1\xd4\xdc\xd6Z\x00\x19j\xe8"@\xb4y7i\xa2I\x0b\xfa,s\x187\rw\xb9\xa1\xa3\xea\xb3\xcb\xa5\xd2\x83g\xf2\xda\xc6\te\x1bY\x97\xee\xf1<\x11Y\x88\xb5(\x9fQ\x90D\x05\xb4w\x1f3\x91\'\xf2\xee"\xcbF\x17\x92d\xef\xccg\xd85fW\xfd\x82\n\x01\x08Q%\x80u\xbb',
                       b'5\x19\x80\x80d\xa6\r\xc7=\t\x13\x11\x93\xe8(r\x1bN\xa2\xb9\x19\x1f\x8b\xa8y\xe9\xbb\xf3k\xc3&\xe0\x9dD\x8am\xdb+BM\xc9\x1f\x08f\xdd\x17c\xe2F=Es\x92\t\x1c}i\x02\x9b\xe2r\xb9E\x1e\xc3n[\xc1\xda\t\xd2\x06\x81\x11\xcc\xb0\x1e.\xb0p\x82T\xa3\x98\xb6\xad\xed\xbdSDX\x01P\xf1+0KK!\xab',
                       b'\xcb\xab\x83t\xd5!\xe9\\\xd25~\x99\xef[\x9b<\xe3\xc2\xbf\xe3\x9fN\xa8\xd1\xa3\xdb\xed\xbf\xdcT\xfc/[4\\\xc5\r\xf0\xb68\x18<\xee\xdc\xa6\xd2\x10\xad\xe9\xfby\xd8\x0f\x8b\xbc\x14\x8b\xaa0\x006\x10(\x0f\xdf\xdd\xae\xe1\x0bT\xc61\xe7\x9d\x1d\xb8A"]\xeb"\x92\xff\xb5H\x06\x92\x9e\xb2\\R\x0c\xf1S\xc6z\xa2\x00\xf5\x97'],
                   [
                       b'\xf2\xc8\xfc\x14~\x9a\xeb<\x11\x94(\xd5K*\xce\x0eX\x18\x97\xd4\n\xe1\xe3\x95\xa0 \xe3\x88w&9\xf0g\xa2\xed3\xd9\xdbV\x88\xfayHN=<\xe8\xbe\xaa\xaf\x11\xe0 \xbd8\r6\xf6\xaf\xf7\x0cK\xc5\xa7J@\x0bE\xd4m\x98i\xf2+T|\x06\x19\x8d\xc4\x94[oU\x16p\x89\x9a\xa7G\xb8)\xcd.\xee\xcb\xf2?\xc8\xf3',
                       b'\xdb\x0e\xb5\x88\x1c\x1a\xa7zD\x11omE&\xf9\xa0J\xcf.\xfe\xbd\xc5\xae\xa0\x93:O\x16\xde~] \xf1\xa2\xb2zj\x11\x00\xe6\xa5\xa6#(E\xfe\xf1{\xb0"&\x99\x13\xc8\x87\x8b\xcf\xa6\xcf&>o\xe0C7\xd1a\xc8\rn\x87x\xab.\xccA\xb3~E\xbb\xd5\x1f>{\xe5\xb2a+\x9f\x84\xcb\x86T\x93h\xfdl\xbd\xbaG',
                       b'k\x92&\\<\xa1\xeb\x85\xa5\xc7;\xef\xe9<\xf3\x91P\x1b\xd1%\xab3\x03m\xbb\xbf\x12_\xf1\xcf\x0et\x93\xb8\xde)D\x99\x11\xe1\xb0\xe3\xd9><4\x84\x00OJ\x1eu\x9d\x88I\xb5Z\xe3\x9e\xb6\x01\xddF\x03\xabq\xb6\x01/\x0f\xdf\xb7|\x19$5{1`O}\xb0f\x8d\x18\x9e&\xa2\xae\xed\x83\x14\x95F\xe1\x1d\x07\xfa\xb8\xbc',
                       b'\n\xea\xfa!J\xd0\xb8\xe4\xe2?O\xa9]\xd6\x18\xad\x07p\xa4\xb9C\x16\x08r\xc2\xc7\xd5L$\x83(\x93\xbc\xbd\xf2\xa6\x9f$\x94\xaa\x1f\x07\xe7\xe0!U\xfa\xf2\xb3\x0c\xf8M\r\x08`c0\x17\xef\xf3{8#;\xe4\x9fo\x921B\x08\x84\xddN\x0e~\x81\xfc\xe9\xd2\xfa\xe5\x02O*\xc2I}\x99\x10\x14\xde\x92\xc2D\xb2\xfe\x18v\x97',
                       b'\xf5V\xb3\x99\xaa\xcc\x92s\xce\x1e\xcf\xba\xa8\x9cU\xfb\x0b\xbf\xef\x9cU\x1b\xaf\x1d\xb2\x7f\xb8\x85<\xf5*,\x9f\x05oA\xdd\xaa\xbe\x07\xe6\xa2\x8d\x80\x06fL\xa3av\x9aX)\x02&\xa5\x0f\xb3\xed)\xa1\x7f\x89\xf9\xc2*\xd4Lp?O\xd1s\xe7\x05\xa6u%\xfa\x9f\xba\xfd\xe9O{.\xf7\xf1\x0e\xc1\xa4W\xb3\xb0\xf9r\\\x86\xab\xbe'],
                   [
                       b'\xb1\x9a\xb4\xe3\xfe\xd5\x8c\xd0\xaf\xbd\xa0\x10\x02wn\x0e\xbc\xf7\xc7\x0fJO(j\x13BY\x8cR\xf6\xc2\x8f\xa0\xc8\\1\x0b\xe2-\xe2X\x9b\xa6t\xfb\x9a(@\xc1\x9d\xaa\x8fK\xdc@@z\x8a\xb7\x8c\x85"\x9e\x01\x14t\xf6\xb7\x1f\xe7\xc2o\xccF\xd8\x95\x0f\x8f\xb6\xd58\x1e\xd6\xd7\xf5\xea\xe3Kp\x10\x89\x8ew\xe8\x87\t\xdb(\x83L',
                       b"\xccc\x9d\x06\\x\xe5\xf9\xea\xc7\xbfp\x92*zC\x81wh\x92_\xd9\x13s\xe2\xe6U\x03T8\xaf!\xe7\xb4\xdf'\xdf\xd2\xea1H\xb4\xb0\x01v\xde\xf1\x91\xae\xa9\x81\xc0\xf3$\xdb:\n\x11N\xb4\xf0\x9f\xaf\xd8k\xc2\xb0\xf6\x04\xa8\x9aY\xe2\x19\xb9GG\xcbEu\x9e\x0c\x94X\x0b\xd5[\xb6?\xe3\xf6\xddi\xe5\xect_\xb1\xb1\xf6",
                       b'\xe2.\xb4\x80Y\x89Y\x00\x97\xca\xf6\xa6!\xb2\xe8\xf3Y\x9d\x1f\x15\x06\x1e\x16\xda\xdb\x17\r\x80\x1a\xe9\x89\xd5\x9a;j\xf8\x9aX!v\xc49\x9cN\xfc\xcd\xe4\x1a\xad\xb8\xc8\xbe\xbd\xce\x02\x15)/\x96\xd4\x00\xa8\x83\xbb\xa3\xd3\xa8\xd3\xed\x14\xc8\xa7\x9c<\xd5\xb5\x08z\x00^\xed\xa04\xf0\xaf?\xfa\x03+!tO;:\xf1\xaa1\x91\x01\x04',
                       b'\xd36\xfe6\x1d\x04L\xc0\xe4K4bNB\xce<\x0f\xe5\xcdq\xc0\xdc&n\xd0\xf0\x86\xa0\xb7\r\x9a\xce\x07B\x8aO\x03\xea\xb0=\xd4\xf4\xf7\x07BQ\xa0;\xc8\xd1\xe7Wifl1\xe2,\xedww\xa7\x1bM\x01:\xfbLrc\x9b\xce3\x8aTyK\x06^H\x96\xe2\xbb!=\x8c[\xdc\xa5\x00\x19\xc6\x8a\xcc\xf9\xd8\tt@\xfe',
                       b'\x84\x85\x9b\xac+\x93\n\xef\xfe-\xf5\xe5\xba,\xcf\xbeNF!\xed\x15\x02\xb4U\xf3\xda\xea\x82\xf8\x00d0+\xb3\x8e\x1e@\xc2+6\xed\x1a\xfey\xb1\xa3\x98{<&\xbfa_\xd0\xbb\xc6h|\xe4\xdfD\xec\x1f.ZDS!@H^\xd1\xcd\xd3@">\xffJ\xbc$\x9f15%\n|\x82\xe6E\xbe\xdaB\xa9Gp\xf6\xa5\x04\x8d'],
                   [
                       b'h\x04P\xc9\xa6\x95\xa2a\x88\xd6MI\x0cd\nk\xca?6{aNMmV\xc8a\xec\xe5Gm:\xf67n\x04$\xdf\xf7r\xbb\x05\xed&\xf9\xea\x8b\n\xa3\xd5\xdd\x1b\x93\x7f\xb5q\x12\x95j8,0\xdf\xdf\xd8\xcd\xd1\x13$"\r\xe4\xba\xd9RH\xe94\xa9\x01\\xq\xd8\xb3\xf9\xe9\xf6\x84L!%{\x13\xd15\xa6\xa8\xfd\x08',
                       b"\xa6\x1f\x92C\xc0\xa1\xb9$r'q\x01a0&\x8d\xa6\xdf\xf2\xd9r2Wu\x1e\xb4b1\x83\xa4Fj\xea3\xff\x9d\xd6\xc9O\x7f4\xec\x81^\x8d\xc9c\xfb\x0c\xc5\x07\xb2\xae\x0bfN\x18\x03\x95@\xc9\x1e\xcb\x1e\xd5\x10\x10c\x92\x7f\xcbt\xb1\x88\xbd\x914\xee\xed\x84\x83\xd7Y&\xeb2>\xaa\xba3]\xf3|7cn\xd6\x15R\xad",
                       b'\xc1\x8d4\xb7\xbb\xf6y\xb3j\x97L<\xfc\xd9\xd8\xd7z\xe7\x069\x0f\x1d\xe4fY\xc7\x96+\x0eD*$\xe3R\x1c\xba\xe9\x8do\xd9F\x00\x0f\xc5*Y\x96F\xda\xa4LG\x1dS\xa2_\xb2\x8b\xa5\xdf5\x854H\x8e\xee\xe3Q\xb7\xbdL&\xba\x06z\x1b\xc2~\x14\xe1\xcf\x0c\x0eMpS]\x01\x96\xc1\x85\xf2\xb15\xc2Y\xaa/\xce\xf4',
                       b'U\x97\r\x10\xce\x9f\x07]]\x17\xce\xb0p2>\x9a\x85\xad\xbb\x9f\xd7$\xe6\x07\x95\x02X\xa5\xc9\x89\xe2\xc0\xb9\xceo\xcf\x9b\xbe\xf1nD\x01\x80\x18\xc2\xbe\x04\xb7\xf1\x94%\x06\xe7){\x04\xa0\xeb\x902U\xdaDq\xf3\x8d\x15\x90\xc4\xd6\xe6\xa8 \r\xd3\x9a[\xb2/_\xbc\xf8`\x82\x1b\x06\xb3-\x9e\xca\xc48\xbf\x81@\x82\xb8\x1c\xcf\xa3',
                       b'\x82k\n\\\x96\xdd\xd4I\xb1\xb1!\xa6\x1e\x06\x96\x84x\x1b\x17\xf3|~\x0c\xc5=\xc2\xeb\xd6\x82\xb6\xf9[\xce\x98\xdfb\x10Z\x82\xa4\xe1\x95|,\x9a\xf3-"\x8ca\xb7\xcc\xbb\x89\x87\x86k\xf14\xf4[ \xc1\xbd|\xca\xfb\x17\xea\xdd\x06Y}\x96\xcc\x95\x12\xd1\xbf<\xafL^c\x92Hb\x12\x84A\xcf\x93\xbe%]\xc9\xa5\x9f\xa9_']])

matrix2 = np.array([
    [b'qwert', b'yuiop', b'asdfg'],
    [b'hjkl?', b'zxcvb', b'nm,.-']
])

n1, n2 = 5, 3
choice1, choice2 = 4, 2
enc_len1, enc_len2 = 100, 5


def test_sender():
    socket = ServerSocket(9000)
    sender = OTSender(n2, socket, pk)
    sender.send_secrets(matrix2)
    socket = ServerSocket(9001)
    sender = OTSender(n1, socket, pk)
    sender.send_secrets(matrix1)


def test_receiver():
    socket = ClientSocket('localhost', 9000)
    recv = OTReceiver(n2, socket, pk, sk, enc_len2)
    res = recv.recv_secret(choice2)
    assert (res == matrix2[:, choice2]).all()
    socket = ClientSocket('localhost', 9001)
    recv = OTReceiver(n1, socket, pk, sk, enc_len1)
    res = recv.recv_secret(choice1)
    assert (res == matrix1[:, choice1]).all()
